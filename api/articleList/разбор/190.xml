<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<root>
  <title>«Медуза» нашла уязвимость в системе интернет-голосования. Часть голосов можно расшифровать еще до официального подсчета</title>
  <second_title/>
  <description>На общероссийском голосовании о внесении изменений в Конституцию РФ продолжился эксперимент с интернет-голосованием. Разработчики изменили систему голосования так, что избиратель теперь может гарантированно расшифровать собственный голос. С одной стороны, так легче принуждать к участию в голосовании. С другой — так можно отчасти проконтролировать честность подсчета голосов.</description>
  <keywords>новости, политика, расследование, репортаж, интервью, реакция, исследование, опрос, тест, президент, приговор, доллар, нефть, экономика, цены, средства, информация, компания, фото, видео, украина, сепаратисты, война, краткий пересказ, бестселлер</keywords>
  <nameTag>разбор</nameTag>
  <name>Meduza</name>
  <url/>
  <date>1.7.2020</date>
  <content>&lt;p&gt;На общероссийском голосовании о внесении изменений в Конституцию РФ продолжился эксперимент с интернет-голосованием. Разработчики изменили систему голосования так, что избиратель теперь может гарантированно расшифровать собственный голос. С одной стороны, так легче принуждать к участию в голосовании. С другой — так можно отчасти проконтролировать честность подсчета голосов.&lt;/p&gt;&lt;h3&gt;Департамент информационных технологий Москвы изменил схему шифрования голоса избирателя&lt;/h3&gt;&lt;p&gt;В 2019 году департамент информационных технологий Москвы разработал систему дистанционного голосования с использованием блокчейна. Тогда голоса избирателей шифровали с помощью собственной реализации &lt;span data-id="875776" data-title="Что это такое?" class="FootnoteLink" data-body="&amp;amp;lt;p&amp;amp;gt;Это система асимметричного шифрования с открытым ключом, предложенная в 1985 году доктором Стэнфордского университета Тахером Эль-Гамалем.&amp;amp;lt;/p&amp;amp;gt;"&gt;схемы Эль-Гамаля&lt;/span&gt;. Эксперты дважды находили в ней разного рода уязвимости.&lt;/p&gt;&lt;p&gt;Теперь в браузере избирателя его голос &lt;a href="https://github.com/moscow-technologies/blockchain-voting/blob/voting2020/elec2020/frontend-library-source/crypto-lib/src/cryptor.js" target="_blank" rel="noopener"&gt;шифруется&lt;/a&gt; с помощью JavaScript-библиотеки &lt;a href="https://tweetnacl.js.org/" target="_blank" rel="noopener"&gt;TweetNaCl.js&lt;/a&gt;. Ее автор Дмитрий Честных узнал от «Медузы» об использовании своей программы разработчиками дистанционного электронного голосования.&lt;/p&gt;&lt;h3&gt;Теперь до официального подсчета голосов (!) интернет-избиратель может сам расшифровать свой голос или разрешить это сделать посторонним&lt;/h3&gt;&lt;p&gt;Предыдущая система со схемой Эль-Гамаля обеспечивала &lt;em&gt;вероятностное&lt;/em&gt; шифрование голоса избирателя: при использовании одних и тех же параметров на практике всегда получался новый шифротекст. Сообщение нельзя было наверняка расшифровать, не раздобыв секретный ключ получателя (избиркома).&lt;/p&gt;&lt;p&gt;Новая система отличается &lt;em&gt;детерминированным&lt;/em&gt; шифрованием: использование одних и тех же параметров приводит к формированию идентичных шифротекстов. Более того, отправитель и получатель формируют общий ключ (shared key), который пригоден как для шифрования сообщения, так и для его расшифровки.&lt;/p&gt;&lt;p&gt;То есть избиратель теперь не только может отправить зашифрованный выбор на сервер избиркома, откуда он попадет в блокчейн, но и успешно расшифровать его. Ему не нужно ждать начала официального подсчета голосов и публикации секретного ключа избирательной комиссии — достаточно сохранить свой секретный ключ, формируемый в браузере на странице электронного бюллетеня.&lt;/p&gt;&lt;p&gt;Мы провели эксперимент, и оказалось, что раздобыть свой секретный ключ сравнительно легко.&lt;/p&gt;&lt;h3&gt;Мы успешно расшифровали голоса избирателей, участвовавших в нашем эксперименте&lt;/h3&gt;&lt;h3&gt;Плохая новость: так можно принуждать к голосованию&lt;/h3&gt;&lt;p&gt;Теперь в теории работодатель может не только проверить, что его сотрудник точно проголосовал (потребовав указать &lt;a href="https://meduza.io/feature/2020/06/26/esli-vy-esche-ne-progolosovali-elektronno-to-vot-sposob-kotoryy-dolzhen-pomoch-proverit-pravilno-li-uchli-vash-golos" target="_blank" rel="noopener"&gt;конкретную транзакцию с голосом&lt;/a&gt;), но и выяснить, каким образом тот распорядился своим голосом (потребовав сохранить секретный ключ). При этом необязательно, чтобы сотрудник был технически подкованным. Его, к примеру, могут попросить установить специальное расширение для браузера, которое подменит сгенерированные ключи на статичные. Таким образом, задача по расшифровке голосов будет сильно упрощена.&lt;/p&gt;&lt;h3&gt;Хорошая новость: так можно контролировать подсчет&lt;/h3&gt;&lt;p&gt;Но эту же особенность можно использовать для контроля честности подсчета голосов, когда избирком отказывается обнародовать расшифровку каждого конкретного голоса (&lt;a href="https://meduza.io/slides/meriya-sluchayno-pozvolila-rasshifrovat-golosa-na-vyborah-v-mosgordumu-my-eto-sdelali-i-nashli-koe-chto-strannoe" target="_blank" rel="noopener"&gt;как это было в 2019 году&lt;/a&gt;). К примеру, сторонники одного из кандидатов могут договориться об установке такого же расширения для браузера. В этом случае прямо по ходу голосования они могут отслеживать минимум голосов, который точно должен получить их кандидат после подсчета.&lt;/p&gt;&lt;p&gt;Разработчики системы интернет-голосования могут запретить избирателям пользоваться одной и той же парой ключей, но это их не спасет. Дмитрий Честных предложил возможные пути обхода такого запрета: «Например, такое расширение может генерировать ключи детерминистически, взяв хэш от статичного секрета и имени (и какого-нибудь номера избирателя) — тогда это обнаружить будет сложно, потому что пары ключей будут разные, но тот, кто владеет секретом, может их заново сгенерировать». То есть для внешнего наблюдателя ключи, сгенерированные расширением, будут выглядеть случайными, но авторы этого расширения смогут восстановить ключи, зная определенные дополнительные параметры. Еще один вариант, предложенный автором TweetNaCl.js: «Расширение может просто писать ключи в центральную базу. Алгоритм Curve25519 очень быстрый, поэтому расшифровать миллионы голосов не составит труда».&lt;/p&gt;&lt;p&gt;«В любом случае это, конечно, полный бред, а не система электронного голосования», — резюмировал Дмитрий Честных.&lt;/p&gt;&lt;p&gt;Чтобы закрыть эту лазейку, департаменту информационных технологий Москвы придется снова полностью менять схему шифрования голосов избирателей. Вряд ли это можно успеть сделать до единого дня голосования в сентябре 2020 года.&lt;/p&gt;&lt;h3&gt;Неожиданный бонус! Избиратели смогут оставлять сообщения в электронных бюллетенях — подобно надписям на бумажных&lt;/h3&gt;&lt;p&gt;На странице электронного бюллетеня в браузере избирателя генерируется не только пара ключей, но и nonce — специальное число, которое должно меняться при создании нового шифротекста (&lt;strong&gt;n&lt;/strong&gt;umber used only &lt;strong&gt;once&lt;/strong&gt;).&lt;/p&gt;&lt;p&gt;Оно генерируется случайным образом, но теоретически его тоже можно подменить с помощью расширения. Это число достаточно длинное, чтобы персонализировать бюллетень. 24 байта позволяют записать пару слов на русском языке в кодировке UTF-8 (или целую фразу на английском), поставить несколько эмодзи или высказаться каким-то другим образом. На качество шифрования в данном случае это не повлияет.&lt;/p&gt;&lt;p&gt;Правда, чтобы прочитать такое сообщение, скорее всего, тоже нужно будет устанавливать специальное расширение или ждать подборок «расшифрованных» посланий от наблюдателей.&lt;/p&gt;</content>
</root>